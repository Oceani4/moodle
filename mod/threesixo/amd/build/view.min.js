define(["jquery","core/templates","core/notification","core/ajax","core/str","core/modal_factory","core/modal_events"],function(a,b,c,d,e,f,g){function h(){var e=d.call([{methodname:"mod_threesixo_data_for_participant_list",args:{threesixtyid:i}}]);a.when(e[0]).then(function(a){return b.render("mod_threesixo/list_participants",a)}).done(function(c,d){a('[data-region="participantlist"]').replaceWith(c),b.runTemplateJS(d)}).fail(c.exception)}var i,j={VIEW_FEEDBACK:'[data-action="view-feedback"]',DECLINE_FEEDBACK:'[data-action="decline-feedback"]',UNDO_DECLINE:'[data-action="undo-decline"]'},k=function(a){i=a,this.registerEvents()};return k.prototype.registerEvents=function(){a(j.DECLINE_FEEDBACK).click(function(i){i.preventDefault();var j=a(this).data("statusid"),k=a(this).data("name"),l={statusid:j,name:k},m=b.render("mod_threesixo/decline_feedback",l),n=e.get_string("declinefeedback","mod_threesixo");a.when(n).then(function(a){return f.create({title:a,body:m,large:!0,type:f.types.SAVE_CANCEL})}).done(function(b){b.show(),b.getRoot().on(g.hidden,function(){b.destroy()}),b.getRoot().on(g.save,function(){var b=a("#decline-statusid").val(),e=a("#decline-reason").val().trim(),f={statusid:b,declinereason:e},g="mod_threesixo_decline_feedback",i=d.call([{methodname:g,args:f}]);i[0].done(function(){h()}).fail(c.exception)})}).fail(c.exception)}),a(j.UNDO_DECLINE).click(function(b){b.preventDefault();var e=a(this).data("statusid"),f={statusid:e},g="mod_threesixo_undo_decline",i=d.call([{methodname:g,args:f}]);i[0].done(function(){h()}).fail(c.exception)})},k});